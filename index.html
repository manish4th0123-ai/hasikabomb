<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTFâ€‘8" />
<meta name="viewport" content="width=device-width,initialâ€‘scale=1.0,maximumâ€‘scale=1.0,userâ€‘scalable=no"/>
<title>Hasi Ka Bomb â€“ Jungle Fun Cam</title>
<style>
  body { margin:0; background:#fff; overflow:hidden; display:flex; flex-direction:column; height:100vh; }
  #webar { flex:1; position:relative; }
  #controls { display:flex; justify-content:space-around; background:#f7f700; padding:10px; }
  button { background:#4caf50; color:white; font-size:1.2em; border:none; border-radius:8px; padding:8px 12px; flex:1; margin:0 5px; }
</style>
</head>
<body>

<div id="webar"></div>
<div id="controls">
  <button id="snap">Capture ğŸ“¸</button>
  <button data-filter="nose">Funny Nose ğŸ¤ª</button>
  <button data-filter="lips">Big Lips ğŸ’‹</button>
  <button data-filter="belly">Balloon Belly ğŸˆ</button>
  <button data-filter="ears">Elephant Ears ğŸ˜</button>
  <button data-filter="donkey">Donkey Ears ğŸ´</button>
  <button data-filter="cat">Cat Face ğŸ±</button>
</div>

<script type="module">
import {
  Webcam,
  Player,
  Module,
  Effect,
  Dom,
  ImageCapture
} from 'https://cdn.jsdelivr.net/npm/@banuba/webar/dist/BanubaSDK.browser.esm.js';

async function main(){
  const player = await Player.create({ clientToken: 'YOUR_DEMO_TOKEN_HERE' });
  await player.addModule(new Module('https://cdn.jsdelivr.net/npm/@banuba/webar/dist/modules/face_tracker.zip'));
  await player.use(new Webcam());
  Dom.render(player, '#webar');

  // helper to apply chosen filter effect (youâ€™d have custom .zip effect files)
  async function applyFilter(name){
    // mapping effect names to zip URLs (you'd import your actual custom filters)
    const effectMap = {
      nose: 'effects/funny_nose.zip',
      lips: 'effects/big_lips.zip',
      belly: 'effects/balloon_belly.zip',
      ears: 'effects/elephant_ears.zip',
      donkey: 'effects/donkey_ears.zip',
      cat: 'effects/cat_face.zip'
    };
    await player.applyEffect(new Effect(effectMap[name]));
  }

  document.querySelectorAll('#controls button[data-filter]').forEach(btn=>{
    btn.onclick = ()=>applyFilter(btn.getAttribute('data-filter'));
  });

  const capture = new ImageCapture(player);
  document.getElementById('snap').onclick = async ()=>{
    const blob = await capture.takePhoto();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'hasi-ka-bomb.png';
    document.body.appendChild(a); a.click(); a.remove();
  };

  // Animated jungle overlays: youâ€™d create another Effect .zip for backgrounds
  const sceneEffects = {
    jungle: 'effects/jungle_scene.zip',
    tiger: 'effects/tiger_roar.zip',
    hill: 'effects/hill_top.zip',
    monkey: 'effects/monkey_mischief.zip'
  };
  function applyScene(name){ player.applyEffect(new Effect(sceneEffects[name])); }

  // voice-trigger special: using Web Speech API
  if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recog = new SpeechRecognition();
    recog.continuous = true;
    recog.onresult = evt => {
      const t = evt.results[evt.resultIndex][0].transcript.trim().toLowerCase();
      if (t.includes('happy birthday')){
        player.applyEffect(new Effect('effects/birthday_cake_popup.zip'));
      }
    };
    recog.start();
  }

  // buttons or auto sequence to choose scenes
  // e.g., every 15 sec cycle scenes
  let sc = ['jungle','tiger','hill','monkey'];
  let idx=0;
  setInterval(()=>applyScene(sc[idx++%sc.length]),15000);
}

// run
main().catch(console.error);
</script>
</body>
</html>
