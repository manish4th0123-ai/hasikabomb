<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#7fc971">
  <title>Hasi Ka Bomb - Jungle Fun Cam</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #eaffd0;
      font-family: sans-serif;
    }
    #camera-container {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    video, canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    .button-bar {
      position: absolute;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: center;
      gap: 10px;
      z-index: 10;
    }
    button {
      background-color: #ffeb3b;
      border: none;
      padding: 15px;
      border-radius: 30px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #cddc39;
    }
  </style>
</head>
<body>
  <div id="camera-container">
    <video id="video" autoplay muted playsinline></video>
    <canvas id="canvas"></canvas>
    <img id="overlay-elephant" class="overlay" src="https://i.imgur.com/slt5w4E.png" style="display:none">
    <img id="overlay-donkey" class="overlay" src="https://i.imgur.com/tPjk5cn.png" style="display:none">
    <img id="overlay-cat" class="overlay" src="https://i.imgur.com/EUMH7wX.png" style="display:none">
    <img id="overlay-lips" class="overlay" src="https://i.imgur.com/vu7TJNa.png" style="display:none">
    <img id="overlay-belly" class="overlay" src="https://i.imgur.com/ZWE2fbk.png" style="display:none">
    <img id="birthday-cake" class="overlay" src="https://i.imgur.com/QmS62ye.png" style="display:none">
    <div class="button-bar">
      <button onclick="takeScreenshot()">üì∏</button>
      <button onclick="cycleOverlay()">üêµ Filter</button>
    </div>
  </div>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const overlays = [
      'overlay-elephant',
      'overlay-donkey',
      'overlay-cat',
      'overlay-lips',
      'overlay-belly'
    ];
    let currentOverlayIndex = -1;

    async function initCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
      } catch (e) {
        alert('Camera access denied');
      }
    }

    function drawFrame() {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0);

      if (currentOverlayIndex >= 0) {
        const currentOverlay = document.getElementById(overlays[currentOverlayIndex]);
        if (currentOverlay && currentOverlay.style.display !== 'none') {
          ctx.drawImage(currentOverlay, 0, 0, canvas.width, canvas.height);
        }
      }

      requestAnimationFrame(drawFrame);
    }

    function takeScreenshot() {
      const link = document.createElement('a');
      link.download = 'fun-cam.png';
      link.href = canvas.toDataURL();
      link.click();
    }

    function cycleOverlay() {
      overlays.forEach(id => document.getElementById(id).style.display = 'none');
      currentOverlayIndex = (currentOverlayIndex + 1) % overlays.length;
      document.getElementById(overlays[currentOverlayIndex]).style.display = 'block';
    }

    function startSpeechRecognition() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) return;

      const recognition = new SpeechRecognition();
      recognition.continuous = true;
      recognition.onresult = (event) => {
        for (let i = 0; i < event.results.length; i++) {
          const text = event.results[i][0].transcript.toLowerCase();
          if (text.includes('happy birthday')) {
            showCake();
          }
        }
      };
      recognition.start();
    }

    function showCake() {
      const cake = document.getElementById('birthday-cake');
      cake.style.display = 'block';
      setTimeout(() => {
        cake.style.display = 'none';
      }, 5000);
    }

    window.onload = () => {
      initCamera();
      video.addEventListener('loadeddata', drawFrame);
      startSpeechRecognition();
    };
  </script>
</body>
</html>
